verb[k,3]<-verbr_hilf[1]/nrow(results)}
verb<-as.data.frame(verb)
colnames(verb)<-c("Marke","abs.Verbreitung","rel.Verbreitung")
verbr<-tbl_df(verb)
verbr_2<-arrange(verb,desc(rel.Verbreitung))
write.table(verbr_2,paste("01_",zeitschrift,"_",produkt,"_Verbreitung.csv",sep=""), sep=";", dec=",")
###########################
# Detailbewertung #########
###########################
x<-matrix(rep(0),nrow=length(eval_marken),ncol=13)
x<-as.data.frame(x)
colnames(x)<-c("01_Sympathie",
"02_Marketing",
"03_Preis-Leistungsverhaeltnis",
"04_Produktqualitaet",
"05_Vertriebspolitik",
"06_Innovationsgrad",
"07_Zuverlaessigkeit",
"08_Schnelligkeit",
"09_Reklamationsbearbeitung",
"10_Aussendienstqualitaet",
"11_Innendienstqualitaet",
"12_Markenstaerke",
"13_Zukunftsperspektiven")
rownames(x)<-eval_marken
loop_marken<-c(1:length(eval_marken))
for (i in 2:14) {
for (j in loop_marken) {
x[j,i-1]=mean(results[[paste0("Q",i,"..",j,".")]],na.rm=TRUE)}}
x_sep <- tbl_df(x)
x_sep <- add_rownames(x)
for (l in colnames(x)){
my_Col<-paste(l,sep="")
my_Col=select(x_sep,rowname,matches(l))
write.table(my_Col,paste("02_",zeitschrift,"_",produkt,"_",l,".csv",sep=""), sep=";", dec=",")}
###########################
# aggregierte Bewertung ###
###########################
mensch<-as.data.frame(apply(x[,c("10_Aussendienstqualitaet","11_Innendienstqualitaet")],1,mean))
colnames(mensch)<-c("Mensch")
rownames(mensch)<-eval_marken
write.table(mensch,paste0("03_",zeitschrift,"_",produkt,"_01mensch",".csv"), sep=";", dec=",")
service<-as.data.frame(apply(x[,c("08_Schnelligkeit","07_Zuverlaessigkeit","09_Reklamationsbearbeitung")],1,mean))
colnames(service)<-c("Service")
rownames(service)<-eval_marken
write.table(service,paste0("03_",zeitschrift,"_",produkt,"_02service",".csv"), sep=";", dec=",")
produkt_ag<-as.data.frame(apply(x[,c("03_Preis-Leistungsverhaeltnis","04_Produktqualitaet","06_Innovationsgrad")],1,mean))
colnames(produkt_ag)<-c("Produkt")
rownames(produkt_ag)<-eval_marken
write.table(produkt_ag,paste0("03_",zeitschrift,"_",produkt,"_03produkt_ag",".csv"), sep=";", dec=",")
image<-as.data.frame(apply(x[,c("12_Markenstaerke","01_Sympathie")],1,mean))
colnames(image)<-c("Image")
rownames(image)<-eval_marken
write.table(image,paste0("03_",zeitschrift,"_",produkt,"_04image",".csv"), sep=";", dec=",")
management<-as.data.frame(apply(x[,c("02_Marketing","05_Vertriebspolitik", "13_Zukunftsperspektiven")],1,mean))
colnames(management)<-c("Management")
rownames(management)<-eval_marken
write.table(management,paste0("03_",zeitschrift,"_",produkt,"_05management",".csv"), sep=";", dec=",")
########################################################################################################################
########################################  KLEINE HAENDLER ##############################################################
########################################################################################################################
setwd(paste("z:/Kunden 2015/SN-Verlag",zeitschrift,produkt,sep="/"))
result<-read.table("results.csv", sep=",", fileEncoding="UTF-8", header=TRUE, na.strings="\"\"")
results<-tbl_df(result)
results<-filter(results, Groesse=="Weniger als 10 Mitarbeiter")
#########################
# Verbreitungsgrad ######
#########################
verb<-matrix(rep(0),nrow=length(verbr_marken),ncol=3)
for (k in 1:length(verbr_marken)) {
verb[k,1]<-verbr_marken[k]
verbr_hilf<-summary(results[[paste0("Q",0,"..",k,".")]])
verb[k,2]<-verbr_hilf[1]
verb[k,3]<-verbr_hilf[1]/nrow(results)}
verb<-as.data.frame(verb)
colnames(verb)<-c("Marke","abs.Verbreitung","rel.Verbreitung")
verbr<-tbl_df(verb)
verbr_2<-arrange(verb,desc(rel.Verbreitung))
write.table(verbr_2,paste("kl01_",zeitschrift,"_",produkt,"_Verbreitung.csv",sep=""), sep=";", dec=",")
###########################
# Detailbewertung #########
###########################
x<-matrix(rep(0),nrow=length(eval_marken),ncol=13)
x<-as.data.frame(x)
colnames(x)<-c("01_Sympathie",
"02_Marketing",
"03_Preis-Leistungsverhaeltnis",
"04_Produktqualitaet",
"05_Vertriebspolitik",
"06_Innovationsgrad",
"07_Zuverlaessigkeit",
"08_Schnelligkeit",
"09_Reklamationsbearbeitung",
"10_Aussendienstqualitaet",
"11_Innendienstqualitaet",
"12_Markenstaerke",
"13_Zukunftsperspektiven")
rownames(x)<-eval_marken
loop_marken<-c(1:length(eval_marken))
for (i in 2:14) {
for (j in loop_marken) {
x[j,i-1]=mean(results[[paste0("Q",i,"..",j,".")]],na.rm=TRUE)}}
x_sep <- tbl_df(x)
x_sep <- add_rownames(x)
for (l in colnames(x)){
my_Col<-paste(l,sep="")
my_Col=select(x_sep,rowname,matches(l))
write.table(my_Col,paste("kl02_",zeitschrift,"_",produkt,"_",l,".csv",sep=""), sep=";", dec=",")}
########################################################################################################################
########################################  GROSSE HAENDLER ##############################################################
########################################################################################################################
setwd(paste("z:/Kunden 2015/SN-Verlag",zeitschrift,produkt,sep="/"))
result<-read.table("results.csv", sep=",", fileEncoding="UTF-8", header=TRUE, na.strings="\"\"")
results<-tbl_df(result)
results<-filter(results, Groesse=="10 und mehr Mitarbeiter")
#########################
# Verbreitungsgrad ######
#########################
verb<-matrix(rep(0),nrow=length(verbr_marken),ncol=3)
for (k in 1:length(verbr_marken)) {
verb[k,1]<-verbr_marken[k]
verbr_hilf<-summary(results[[paste0("Q",0,"..",k,".")]])
verb[k,2]<-verbr_hilf[1]
verb[k,3]<-verbr_hilf[1]/nrow(results)}
verb<-as.data.frame(verb)
colnames(verb)<-c("Marke","abs.Verbreitung","rel.Verbreitung")
verbr<-tbl_df(verb)
verbr_2<-arrange(verb,desc(rel.Verbreitung))
write.table(verbr_2,paste("gr01_",zeitschrift,"_",produkt,"_Verbreitung.csv",sep=""), sep=";", dec=",")
###########################
# Detailbewertung #########
###########################
x<-matrix(rep(0),nrow=length(eval_marken),ncol=13)
x<-as.data.frame(x)
colnames(x)<-c("01_Sympathie",
"02_Marketing",
"03_Preis-Leistungsverhaeltnis",
"04_Produktqualitaet",
"05_Vertriebspolitik",
"06_Innovationsgrad",
"07_Zuverlaessigkeit",
"08_Schnelligkeit",
"09_Reklamationsbearbeitung",
"10_Aussendienstqualitaet",
"11_Innendienstqualitaet",
"12_Markenstaerke",
"13_Zukunftsperspektiven")
rownames(x)<-eval_marken
loop_marken<-c(1:length(eval_marken))
for (i in 2:14) {
for (j in loop_marken) {
x[j,i-1]=mean(results[[paste0("Q",i,"..",j,".")]],na.rm=TRUE)}}
x_sep <- tbl_df(x)
x_sep <- add_rownames(x)
for (l in colnames(x)){
my_Col<-paste(l,sep="")
my_Col=select(x_sep,rowname,matches(l))
write.table(my_Col,paste("gr02_",zeitschrift,"_",produkt,"_",l,".csv",sep=""), sep=";", dec=",")}
########################################################################################################################
########################################  OST HAENDLER    ##############################################################
########################################################################################################################
setwd(paste("z:/Kunden 2015/SN-Verlag",zeitschrift,produkt,sep="/"))
result<-read.table("results.csv", sep=",", fileEncoding="UTF-8", header=TRUE, na.strings="\"\"")
results<-tbl_df(result)
results<-filter(results, Q21b=="Ost")
#########################
# Verbreitungsgrad ######
#########################
verb<-matrix(rep(0),nrow=length(verbr_marken),ncol=3)
for (k in 1:length(verbr_marken)) {
verb[k,1]<-verbr_marken[k]
verbr_hilf<-summary(results[[paste0("Q",0,"..",k,".")]])
verb[k,2]<-verbr_hilf[1]
verb[k,3]<-verbr_hilf[1]/nrow(results)}
verb<-as.data.frame(verb)
colnames(verb)<-c("Marke","abs.Verbreitung","rel.Verbreitung")
verbr<-tbl_df(verb)
verbr_2<-arrange(verb,desc(rel.Verbreitung))
write.table(verbr_2,paste("OST01_",zeitschrift,"_",produkt,"_Verbreitung.csv",sep=""), sep=";", dec=",")
###########################
# Detailbewertung #########
###########################
x<-matrix(rep(0),nrow=length(eval_marken),ncol=13)
x<-as.data.frame(x)
colnames(x)<-c("01_Sympathie",
"02_Marketing",
"03_Preis-Leistungsverhaeltnis",
"04_Produktqualitaet",
"05_Vertriebspolitik",
"06_Innovationsgrad",
"07_Zuverlaessigkeit",
"08_Schnelligkeit",
"09_Reklamationsbearbeitung",
"10_Aussendienstqualitaet",
"11_Innendienstqualitaet",
"12_Markenstaerke",
"13_Zukunftsperspektiven")
rownames(x)<-eval_marken
loop_marken<-c(1:length(eval_marken))
for (i in 2:14) {
for (j in loop_marken) {
x[j,i-1]=mean(results[[paste0("Q",i,"..",j,".")]],na.rm=TRUE)}}
x_sep <- tbl_df(x)
x_sep <- add_rownames(x)
for (l in colnames(x)){
my_Col<-paste(l,sep="")
my_Col=select(x_sep,rowname,matches(l))
write.table(my_Col,paste("OST02_",zeitschrift,"_",produkt,"_",l,".csv",sep=""), sep=";", dec=",")}
########################################################################################################################
########################################  WEST HAENDLER    ##############################################################
########################################################################################################################
setwd(paste("z:/Kunden 2015/SN-Verlag",zeitschrift,produkt,sep="/"))
result<-read.table("results.csv", sep=",", fileEncoding="UTF-8", header=TRUE, na.strings="\"\"")
results<-tbl_df(result)
results<-filter(results, Q21b=="West")
#########################
# Verbreitungsgrad ######
#########################
verb<-matrix(rep(0),nrow=length(verbr_marken),ncol=3)
for (k in 1:length(verbr_marken)) {
verb[k,1]<-verbr_marken[k]
verbr_hilf<-summary(results[[paste0("Q",0,"..",k,".")]])
verb[k,2]<-verbr_hilf[1]
verb[k,3]<-verbr_hilf[1]/nrow(results)}
verb<-as.data.frame(verb)
colnames(verb)<-c("Marke","abs.Verbreitung","rel.Verbreitung")
verbr<-tbl_df(verb)
verbr_2<-arrange(verb,desc(rel.Verbreitung))
write.table(verbr_2,paste("WEST01_",zeitschrift,"_",produkt,"_Verbreitung.csv",sep=""), sep=";", dec=",")
###########################
# Detailbewertung #########
###########################
x<-matrix(rep(0),nrow=length(eval_marken),ncol=13)
x<-as.data.frame(x)
colnames(x)<-c("01_Sympathie",
"02_Marketing",
"03_Preis-Leistungsverhaeltnis",
"04_Produktqualitaet",
"05_Vertriebspolitik",
"06_Innovationsgrad",
"07_Zuverlaessigkeit",
"08_Schnelligkeit",
"09_Reklamationsbearbeitung",
"10_Aussendienstqualitaet",
"11_Innendienstqualitaet",
"12_Markenstaerke",
"13_Zukunftsperspektiven")
rownames(x)<-eval_marken
loop_marken<-c(1:length(eval_marken))
for (i in 2:14) {
for (j in loop_marken) {
x[j,i-1]=mean(results[[paste0("Q",i,"..",j,".")]],na.rm=TRUE)}}
x_sep <- tbl_df(x)
x_sep <- add_rownames(x)
for (l in colnames(x)){
my_Col<-paste(l,sep="")
my_Col=select(x_sep,rowname,matches(l))
write.table(my_Col,paste("WEST02_",zeitschrift,"_",produkt,"_",l,".csv",sep=""), sep=";", dec=",")}
}
SN.Auswertung<-function(zeitschrift,produkt,verbr_marken,eval_marken){
##################
# package dplyr  #
# WriteXLS       #
##################
library(dplyr)
##################
# daten einlesen #
##################
setwd(paste("z:/Kunden 2015/SN-Verlag",zeitschrift,produkt,sep="/"))
result<-read.table("results.csv", sep=",", fileEncoding="UTF-8", header=TRUE, na.strings="\"\"")
results<-tbl_df(result)
#########################
# Verbreitungsgrad ######
#########################
verb<-matrix(rep(0),nrow=length(verbr_marken),ncol=3)
for (k in 1:length(verbr_marken)) {
verb[k,1]<-verbr_marken[k]
verbr_hilf<-summary(results[[paste0("Q",0,"..",k,".")]])
verb[k,2]<-verbr_hilf[1]
verb[k,3]<-verbr_hilf[1]/nrow(results)}
verb<-as.data.frame(verb)
colnames(verb)<-c("Marke","abs.Verbreitung","rel.Verbreitung")
verbr<-tbl_df(verb)
verbr_2<-arrange(verb,desc(rel.Verbreitung))
write.table(verbr_2,paste("01_",zeitschrift,"_",produkt,"_Verbreitung.csv",sep=""), sep=";", dec=",")
###########################
# Detailbewertung #########
###########################
x<-matrix(rep(0),nrow=length(eval_marken),ncol=13)
x<-as.data.frame(x)
colnames(x)<-c("01_Sympathie",
"02_Marketing",
"03_Preis-Leistungsverhaeltnis",
"04_Produktqualitaet",
"05_Vertriebspolitik",
"06_Innovationsgrad",
"07_Zuverlaessigkeit",
"08_Schnelligkeit",
"09_Reklamationsbearbeitung",
"10_Aussendienstqualitaet",
"11_Innendienstqualitaet",
"12_Markenstaerke",
"13_Zukunftsperspektiven")
rownames(x)<-eval_marken
loop_marken<-c(1:length(eval_marken))
for (i in 2:14) {
for (j in loop_marken) {
x[j,i-1]=mean(results[[paste0("Q",i,"..",j,".")]],na.rm=TRUE)}}
x_sep <- tbl_df(x)
x_sep <- add_rownames(x)
print(x_sep)
}
load("Z:/Kunden 2015/SN-Verlag/Heimtex/Tapete/.RData")
source('Z:/Kunden 2015/SN-Verlag/Heimtex/Heimtex_Auswertung.R')
`4bd391007ad411e5aaad0118a105354e` <- read.table("C:/Users/KSB/Downloads/4bd391007ad411e5aaad0118a105354e.txt", header=TRUE, quote="\"")
View(`4bd391007ad411e5aaad0118a105354e`)
`4bd391007ad411e5aaad0118a105354e` <- read.table("C:/Users/KSB/Downloads/4bd391007ad411e5aaad0118a105354e.txt", header=TRUE, quote="\"")
View(`4bd391007ad411e5aaad0118a105354e`)
results2 <- read.csv("Z:/Kunden 2015/SN-Verlag/Heimtex/Tapete/results.csv", header=FALSE)
View(results2)
names(results2)
tail(summary)
tail(results2)
summary(results2$V166)
?frequency
frequency(results2$V166)
frequency(results2$V168)
frequency(results2$V168)
summary(results2$V168)
modellanpassung_RD_creaton <- read.csv("Z:/Kunden 2015/Creaton/RegionalDaten/modellanpassung_RD_creaton.csv", sep=";", dec=",", stringsAsFactors=FALSE)
View(modellanpassung_RD_creaton)
?lm
?model
?model
?lm
?formula
?lm
a<-lm(gesamt1~.-gesamt2-Landkreis_ID, data=modellanpassung_RD_creaton)
summary(a)
library(swirl)
install_from_swirl("Getting and Cleaning Data")
swirl()
mydf<-read.csv(path2csv, stringsAsFactors=FALSE)
dim()
dim(mydf)
head(mydf)
library(dplyr)
packageVersion("dplyr")
cran<-tbl_df(mydf)
rm("mydf")
cran
?select
select(cran,ip_id,package,country)
5:20
select(cran,r_arch:country)
select(cran,country:r-arch)
select(cran,country:r_arch)
cran
select(cran,-time)
-5:20
-(5:20)
select(cran,-(X:size)
)
filter(cran,package=="swirl")
filter(cran, r_version=="3.1.1", country=="US")
?Comparison
filter(cran, r_version<="3.1.1", country=="IN")
filter(cran, r_version<="3.0.2", country=="IN")
filter(cran, country=="US"|country=="IN")
filter(cran, size>100500 & r_os=="linux-gnu")
filter(cran, size>100500 , r_os=="linux-gnu")
is.na(c(3,5,NA,10))
!is.na(c(3,5,NA,10))
filter(cran, !is.na(r_version))
cran2<-select(cran,size:ip_id)
arrange(cran2,ip_id)
arrange(cran2,desc(ip_id))
arrange(cran2,package,ip_id)
arrange(cran2,country,desc(r_version),ip_id)
cran3<-select(ip_id,package,size)
cran3<-select(cran,ip_id,package,size)
cran3
mutate(cran3,size_mb=size/2^20)
mutate(cran3,size_mb=size/2^20,size_gb=size_mb/2^10)
mutate(cran3,correct_size=size-1000)
mutate(cran3,correct_size=size+1000)
summarize(cran,avg_bytes=mean(size))
library(dplyr)
cran<-tbl_df(mydf)
rm("mydf")
cran
?groub_by
?groub_by()
?group_by
by_package<-group_by(cran,package)
by_package
?summarize
summarize(group_by,mean(size))
summarize(by_package,mean(size))
submit()
pack_sum
quantile(pack_sum$count,probs=0.99)
top_counts<-filter(pack_sum,count>679)
top_counts
View(top_counts)
arrange(top_counts, desc(count))
top_counts_sorted<-arrange(top_counts, desc(count))
View(top_counts_sorted)
quantile(pack_sum$unique,probs=0.99)
top_unique<-filter(pack_sum,unique>465)
View(top_unique)
top_unique_sorted<-arrange(top_unique, desc(unique))
View(top_unique_sorted)
submit()
submit()
submit()
View(result3)
submit()
submit()
submit()
submit()
library(tidyr)
students
?gather
gather(students,sex,count,-grade)
students2
res<-gather(students2,sex_class,count)
res<-gather(students2,sex_class,count,-grade)
res
?seperate
?separate
separate(res,sex_class,c("sex","class"))
submit()
submit()
students3
?gather
submit()
?spread()
?spread
submit
submit()
submit()
extract_numeric("class5")
submit()
?extract_numeric
?mutate
submit()
submit()
submit()
submit()
submit()
submit()
submit()
submit()
submit()
submit()
submit()
students4
submit
submit()
submit()
submit()
submit()#
passed
failed
mutate(passed,status="passed")
passed<-passed %>% mutate(passed,status="passed")
passed<-passed %>% mutate(status="passed")
failed<-failed %>% mutate(status="failed")
?bind_rows
bind_rows(passed,failed)
sat
?select
?separate
library(knitr)
install.packages("knitr")
install.packages("slidify")
install.packages("xtable")
?where
?which
missing<-which(is.na(activity$steps))
library(plyr)
library(dplyr)
?mutate
?match
?lookup
?merge
?weekdays
acitvity_weekdays<-filter(activity_days,working==Montag|working=Dienstag|working=Mittwoch|working=Donnerstag|working=Freitag)
?sort
library(dplyr)
?arrange
setwd ("c:/r_dat/repro_pa2")
#storm <- read.csv(bzfile(paste("repdata_data_StormData.csv.bz2", sep = "")),sep=",")
storm_sample<-tbl_df(read.csv("storm_sample2.csv"))
head(storm_sample)
unique(storm_sample$PROPDMG)
unique(storm_sample$PROPDMGEXP)
unique(storm_sample$CROPDMGEXP)
storm <- read.csv(bzfile(paste("repdata_data_StormData.csv.bz2", sep = "")),sep=",")
unique(storm$PROPDMGEXP)
unique(storm$CROPDMGEXP)
?gsup
library(utils)
?gsup
library(ggplot2)
?gsup
?gsub
?barplot
?geom_bar
?barplot#
setwd ("c:/r_dat/repro_pa2")
